# MKV Magic

[![GitHub](https://img.shields.io/badge/GitHub-mkv_magic-blue?logo=github)](https://github.com/vitaluska123/mkv_magic)

## Описание
Современный веб-сервис на Flask для работы с MKV-файлами: извлечение и предпросмотр субтитров, аудио, создание и синхронизация озвучки, предпросмотр видео и субтитров, поддержка пользовательских субтитров, сохранение/загрузка проектов (в т.ч. архивом), расширяемая архитектура, удобный UI.

## Основные возможности
- Загрузка MKV-файлов через drag&drop или диалог.
- Извлечение всех субтитров и аудиодорожек (выбор нужной дорожки).
- Предпросмотр видео с синхронизированными субтитрами и аудио.
- Современный UI: таймлайны (wavesurfer.js), прогресс-бар, навигация, изменение размера видео.
- Запись и синхронизация пользовательской озвучки (voiceover).
- Синхронизация таймлайнов: видео, аудио, субтитры, пользовательская озвучка.
- Скачивание отдельных дорожек или всего проекта архивом (zip: видео, аудио, субтитры, озвучка, настройки).
- Поддержка пользовательских субтитров (загрузка, предпросмотр, выбор).
- Сохранение/загрузка проектов (архивирование всех файлов и настроек).
- Расширяемая архитектура (легко добавить новые форматы или функции).

## Структура проекта
- `web_extract_subs/`
  - `__main__.py` — точка входа (запуск сервера)
  - `views.py` — Flask backend: обработка файлов, маршруты, логика извлечения, озвучки, архивации
  - `static/voiceover.js` — frontend: drag&drop, таймлайны, запись, синхронизация, прогресс-бар, предпросмотр субтитров, изменение размера видео, выбор дорожки
  - `static/style.css` — стилизация интерфейса
  - `templates/voiceover.html` — HTML-шаблон: UI, предпросмотр, выбор субтитров, прогресс-бар, кнопки архивации
  - `requirements.txt` — зависимости
- Корень:
  - `ffmpeg.exe`, `mkvextract.exe`, `mkvmerge.exe` — необходимые бинарники
  - `run_voiceover.bat` — запуск сервера (Windows)

## Установка
1. Клонируйте репозиторий:
   ```
   git clone https://github.com/vitaluska123/mkv_magic.git
   cd mkv_magic
   ```
2. Установите зависимости:
   ```
   python -m venv venv
   venv\Scripts\activate
   pip install -r web_extract_subs/requirements.txt
   ```
3. Поместите `mkvmerge.exe`, `mkvextract.exe`, `ffmpeg.exe` в корень проекта или пропишите их в PATH.

## Запуск
```sh
python -m web_extract_subs
```
или
```sh
flask run -A web_extract_subs.views:app
```
или (Windows)
```sh
run_voiceover.bat
```

## Использование
1. Откройте веб-интерфейс (обычно http://127.0.0.1:5000/).
2. Перетащите MKV-файл или выберите через диалог.
3. Выберите нужные дорожки (субтитры, аудио).
4. Используйте предпросмотр, синхронизируйте озвучку, редактируйте субтитры.
5. Скачайте отдельные дорожки или весь проект архивом.

### Краткое описание интерфейса
- Drag&Drop и кнопка загрузки файлов.
- Предпросмотр видео с субтитрами и аудио.
- Таймлайны для аудио, субтитров, озвучки (wavesurfer.js).
- Кнопки изменения размера видео.
- Выпадающий список для выбора дорожки субтитров.
- Прогресс-бар обработки.
- Кнопки скачивания и архивации.

## Примечания
- Для работы с MKV необходимы утилиты mkvmerge, mkvextract, ffmpeg (Windows: положить в корень, Linux/Mac: прописать в PATH).
- Поддерживаются только SRT-субтитры (опционально: расширить до ass/vtt).
- Все временные и пользовательские файлы игнорируются через .gitignore.

---

**GitHub:** https://github.com/vitaluska123/mkv_magic

**Автор:** [vitaluska123](https://github.com/vitaluska123)
